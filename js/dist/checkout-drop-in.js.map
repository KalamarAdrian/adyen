{"version":3,"sources":["../src/checkout-drop-in.js"],"names":["checkout","AdyenCheckout","pronamicPayAdyenCheckout","configuration","validate_http_status","response","status","Promise","resolve","reject","Error","statusText","get_json","json","dropin","create","paymentMethodsConfiguration","onSubmit","state","send_request","paymentsUrl","data","then","action","handleAction","resultCode","paymentResult","catch","error","onAdditionalDetails","paymentsDetailsUrl","mount","url","fetch","method","cache","headers","body","JSON","stringify","setStatus","message","paymentAuthorised","window","location","href","paymentReturnUrl","refusalReason","paymentRefused","setTimeout","paymentReceived"],"mappings":";;AAAA;AACA,CAAE,YAAY;AACb;;AAEA,MAAMA,QAAQ,GAAG,IAAIC,aAAJ,CAAmBC,wBAAwB,CAACC,aAA5C,CAAjB;;AAEA,MAAMC,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAAC,QAAQ,EAAI;AACxC,QAAKA,QAAQ,CAACC,MAAT,IAAmB,GAAnB,IAA0BD,QAAQ,CAACC,MAAT,GAAkB,GAAjD,EAAuD;AACtD,aAAOC,OAAO,CAACC,OAAR,CAAiBH,QAAjB,CAAP;AACA;;AAED,WAAOE,OAAO,CAACE,MAAR,CAAgB,IAAIC,KAAJ,CAAWL,QAAQ,CAACM,UAApB,CAAhB,CAAP;AACA,GAND;;AAQA,MAAMC,QAAQ,GAAG,SAAXA,QAAW,CAAAP,QAAQ;AAAA,WAAIA,QAAQ,CAACQ,IAAT,EAAJ;AAAA,GAAzB;;AAEA,MAAMC,MAAM,GAAGd,QAAQ,CAACe,MAAT,CAAiB,QAAjB,EAA2B;AACzCC,IAAAA,2BAA2B,EAAEd,wBAAwB,CAACc,2BADb;AAEzCC,IAAAA,QAAQ,EAAE,kBAAEC,KAAF,EAASJ,MAAT,EAAqB;AAC9BK,MAAAA,YAAY,CAAEjB,wBAAwB,CAACkB,WAA3B,EAAwCF,KAAK,CAACG,IAA9C,CAAZ,CACCC,IADD,CACOlB,oBADP,EAECkB,IAFD,CAEOV,QAFP,EAGCU,IAHD,CAGO,UAAAjB,QAAQ,EAAI;AAClB;AACA,YAAKA,QAAQ,CAACkB,MAAd,EAAuB;AACtBT,UAAAA,MAAM,CAACU,YAAP,CAAqBnB,QAAQ,CAACkB,MAA9B;AACA,SAJiB,CAMlB;;;AACA,YAAKlB,QAAQ,CAACoB,UAAd,EAA2B;AAC1BC,UAAAA,aAAa,CAAErB,QAAF,CAAb;AACA;AACD,OAbD,EAcCsB,KAdD,CAcQ,UAAAC,KAAK,EAAI;AAChB;AAEA;AAEA;AAEA,cAAMlB,KAAK,CAAEkB,KAAF,CAAX;AACA,OAtBD;AAuBA,KA1BwC;AA2BzCC,IAAAA,mBAAmB,EAAE,6BAAEX,KAAF,EAASJ,MAAT,EAAqB;AACzCK,MAAAA,YAAY,CAAEjB,wBAAwB,CAAC4B,kBAA3B,EAA+CZ,KAAK,CAACG,IAArD,CAAZ,CACCC,IADD,CACOlB,oBADP,EAECkB,IAFD,CAEOV,QAFP,EAGCU,IAHD,CAGO,UAAAjB,QAAQ,EAAI;AAClB;AACA,YAAKA,QAAQ,CAACkB,MAAd,EAAuB;AACtBT,UAAAA,MAAM,CAACU,YAAP,CAAqBnB,QAAQ,CAACkB,MAA9B;AACA,SAJiB,CAMlB;;;AACA,YAAKlB,QAAQ,CAACoB,UAAd,EAA2B;AAC1BC,UAAAA,aAAa,CAAErB,QAAF,CAAb;AACA;AACD,OAbD,EAcCsB,KAdD,CAcQ,UAAAC,KAAK,EAAI;AAChB,cAAMlB,KAAK,CAAEkB,KAAF,CAAX;AACA,OAhBD;AAiBA;AA7CwC,GAA3B,EA+CdG,KA/Cc,CA+CP,wBA/CO,CAAf;;AAiDA,MAAMZ,YAAY,GAAG,SAAfA,YAAe,CAAEa,GAAF,EAAOX,IAAP,EAAiB;AACrC,WAAOY,KAAK,CACXD,GADW,EAEX;AACCE,MAAAA,MAAM,EAAE,MADT;AAECC,MAAAA,KAAK,EAAE,UAFR;AAGCC,MAAAA,OAAO,EAAE;AAAE,wBAAgB;AAAlB,OAHV;AAICC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAgBlB,IAAhB;AAJP,KAFW,CAAZ;AASA,GAVD;;AAYA,MAAMK,aAAa,GAAG,SAAhBA,aAAgB,CAAErB,QAAF,EAAgB;AACrC;;;;;AAKA,YAASA,QAAQ,CAACoB,UAAlB;AACC,WAAK,YAAL;AACC;AACAX,QAAAA,MAAM,CAAC0B,SAAP,CAAkB,SAAlB,EAA6B;AAAEC,UAAAA,OAAO,EAAEvC,wBAAwB,CAACwC;AAApC,SAA7B;AAEA;;;;AAGAC,QAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB3C,wBAAwB,CAAC4C,gBAAhD;AAEA;;AACD,WAAK,OAAL;AACC;;AAEA;;;AAGA,YAAKzC,QAAQ,CAAC0C,aAAd,EAA8B;AAC7BjC,UAAAA,MAAM,CAAC0B,SAAP,CAAkB,OAAlB,EAA2B;AAAEC,YAAAA,OAAO,EAAEpC,QAAQ,CAAC0C;AAApB,WAA3B;AACA;;AAED;;AACD,WAAK,SAAL;AACC;;AAEA;;;AAGAJ,QAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB3C,wBAAwB,CAAC4C,gBAAhD;AAEA;;AACD,WAAK,kBAAL;AACC;;AAEA;;;;;;;AAOA;;AACD,WAAK,SAAL;AACC;;AAEA;;;AAGAhC,QAAAA,MAAM,CAAC0B,SAAP,CAAkB,OAAlB,EAA2B;AAAEC,UAAAA,OAAO,EAAEvC,wBAAwB,CAAC8C,cAAzB,GAA0C,IAA1C,GAAiD3C,QAAQ,CAAC0C,aAA1D,GAA0E;AAArF,SAA3B;AAEAE,QAAAA,UAAU,CACT,YAAM;AACLnC,UAAAA,MAAM,CAAC0B,SAAP,CAAkB,OAAlB;AACA,SAHQ,EAIT,IAJS,CAAV;AAOA;;AACD,WAAK,UAAL;AACC;AACA1B,QAAAA,MAAM,CAAC0B,SAAP,CAAkB,SAAlB,EAA6B;AAAEC,UAAAA,OAAO,EAAEvC,wBAAwB,CAACgD;AAApC,SAA7B;AAEA;;;;AAGAP,QAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB3C,wBAAwB,CAAC4C,gBAAhD;AAEA;AAnEF;AAqEA,GA3ED;AA4EA,CAxJD","sourcesContent":["/* global AdyenCheckout, pronamicPayAdyenCheckout */\n( function () {\n\t'use strict';\n\n\tconst checkout = new AdyenCheckout( pronamicPayAdyenCheckout.configuration );\n\n\tconst validate_http_status = response => {\n\t\tif ( response.status >= 200 && response.status < 300 ) {\n\t\t\treturn Promise.resolve( response );\n\t\t}\n\n\t\treturn Promise.reject( new Error( response.statusText ) );\n\t};\n\n\tconst get_json = response => response.json();\n\n\tconst dropin = checkout.create( 'dropin', {\n\t\tpaymentMethodsConfiguration: pronamicPayAdyenCheckout.paymentMethodsConfiguration,\n\t\tonSubmit: ( state, dropin ) => {\n\t\t\tsend_request( pronamicPayAdyenCheckout.paymentsUrl, state.data )\n\t\t\t.then( validate_http_status )\n\t\t\t.then( get_json )\n\t\t\t.then( response => {\n\t\t\t\t// Handle action object.\n\t\t\t\tif ( response.action ) {\n\t\t\t\t\tdropin.handleAction( response.action );\n\t\t\t\t}\n\n\t\t\t\t// Handle result code.\n\t\t\t\tif ( response.resultCode ) {\n\t\t\t\t\tpaymentResult( response );\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.catch( error => {\n\t\t\t\t//alert( error );\n\n\t\t\t\t//dropin.setStatus( 'error', { message: response.error } );\n\n\t\t\t\t//setTimeout( function() { dropin.setStatus( 'ready' ); }, 5000 );\n\n\t\t\t\tthrow Error( error );\n\t\t\t} );\n\t\t},\n\t\tonAdditionalDetails: ( state, dropin ) => {\n\t\t\tsend_request( pronamicPayAdyenCheckout.paymentsDetailsUrl, state.data )\n\t\t\t.then( validate_http_status )\n\t\t\t.then( get_json )\n\t\t\t.then( response => {\n\t\t\t\t// Handle action object.\n\t\t\t\tif ( response.action ) {\n\t\t\t\t\tdropin.handleAction( response.action );\n\t\t\t\t}\n\n\t\t\t\t// Handle result code.\n\t\t\t\tif ( response.resultCode ) {\n\t\t\t\t\tpaymentResult( response );\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.catch( error => {\n\t\t\t\tthrow Error( error );\n\t\t\t} );\n\t\t}\n\t} )\n\t.mount( '#pronamic-pay-checkout' );\n\n\tconst send_request = ( url, data ) => {\n\t\treturn fetch(\n\t\t\turl,\n\t\t\t{\n\t\t\t\tmethod: 'POST',\n\t\t\t\tcache: 'no-cache',\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\tbody: JSON.stringify( data )\n\t\t\t}\n\t\t);\n\t};\n\n\tconst paymentResult = ( response ) => {\n\t\t/*\n\t\t * Handle payment result\n\t\t *\n\t\t * @link https://docs.adyen.com/checkout/drop-in-web#step-6-present-payment-result\n\t\t */\n\t\tswitch ( response.resultCode ) {\n\t\t\tcase 'Authorised':\n\t\t\t\t// The payment was successful.\n\t\t\t\tdropin.setStatus( 'success', { message: pronamicPayAdyenCheckout.paymentAuthorised } );\n\n\t\t\t\t/*\n\t\t\t\t * Inform the shopper that the payment was successful.\n\t\t\t\t */\n\t\t\t\twindow.location.href = pronamicPayAdyenCheckout.paymentReturnUrl;\n\n\t\t\t\tbreak;\n\t\t\tcase 'Error':\n\t\t\t\t// Inform the shopper that there was an error processing their payment.\n\n\t\t\t\t/*\n\t\t\t\t * You'll receive a `refusalReason` in the same response, indicating the cause of the error.\n\t\t\t\t */\n\t\t\t\tif ( response.refusalReason ) {\n\t\t\t\t\tdropin.setStatus( 'error', { message: response.refusalReason } );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'Pending':\n\t\t\t\t// The shopper has completed the payment but the final result is not yet known.\n\n\t\t\t\t/*\n\t\t\t\t * Inform the shopper that you've received their order, and are waiting for the payment to be completed.\n\t\t\t\t */\n\t\t\t\twindow.location.href = pronamicPayAdyenCheckout.paymentReturnUrl;\n\n\t\t\t\tbreak;\n\t\t\tcase 'PresentToShopper':\n\t\t\t\t// Present the voucher or the QR code to the shopper.\n\n\t\t\t\t/*\n\t\t\t\t * For a voucher payment method, inform the shopper that you are waiting for their payment. You will receive the final result of the payment in an AUTHORISATION notification.\n\t\t\t\t *\n\t\t\t\t * For a qrCode payment method, wait for the AUTHORISATION notification before presenting the payment result to the shopper.\n\t\t\t\t *\n\t\t\t\t * @todo\n\t\t\t\t */\n\t\t\t\tbreak;\n\t\t\tcase 'Refused':\n\t\t\t\t// The payment was refused.\n\n\t\t\t\t/*\n\t\t\t\t * Inform the shopper that the payment was refused. Ask the shopper to try the payment again using a different payment method or card.\n\t\t\t\t */\n\t\t\t\tdropin.setStatus( 'error', { message: pronamicPayAdyenCheckout.paymentRefused + ' (' + response.refusalReason + ')' } );\n\n\t\t\t\tsetTimeout(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tdropin.setStatus( 'ready' );\n\t\t\t\t\t},\n\t\t\t\t\t8000\n\t\t\t\t);\n\n\t\t\t\tbreak;\n\t\t\tcase 'Received':\n\t\t\t\t// For some payment methods, it can take some time before the final status of the payment is known.\n\t\t\t\tdropin.setStatus( 'success', { message: pronamicPayAdyenCheckout.paymentReceived } );\n\n\t\t\t\t/*\n\t\t\t\t * Inform the shopper that the payment was refused. Ask the shopper to try the payment again using a different payment method or card.\n\t\t\t\t */\n\t\t\t\twindow.location.href = pronamicPayAdyenCheckout.paymentReturnUrl;\n\n\t\t\t\tbreak;\n\t\t}\n\t};\n} )();\n"],"file":"checkout-drop-in.js"}